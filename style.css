// Obtém a chave da API a partir de uma variável de ambiente
const apiKey = process.env.EXCHANGE_API_KEY; // Configurado no Vercel

// Função para obter a cotação
async function obterCotacao() {
  const origem = document.getElementById('moeda-origem').value;
  const destino = document.getElementById('moeda-destino').value;
  
  const url = `https://v6.exchangerate-api.com/v6/${apiKey}/latest/${origem}`;

  try {
    const resposta = await fetch(url);
    const dados = await resposta.json();
    
    const cotacao = dados.conversion_rates[destino];
    document.getElementById('cotacao').textContent = `1 ${origem} = ${cotacao} ${destino}`;
    
    return cotacao;
  } catch (erro) {
    alert('Erro ao buscar cotação. Tente novamente.');
    console.error(erro);
  }
}

// Função para realizar a conversão
async function converter() {
  const valor = parseFloat(document.getElementById('valor').value);
  
  if (isNaN(valor)) {
    alert('Por favor, insira um valor válido.');
    return;
  }

  const cotacao = await obterCotacao();
  const resultado = valor * cotacao;

  document.getElementById('resultado').textContent = resultado.toFixed(2);
}
